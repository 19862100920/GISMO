<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of specgram2</title>
  <meta name="keywords" content="specgram2">
  <meta name="description" content="SPECGRAM2 - plots spectrograms of waveforms with waveform along top">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">GISMO</a> &gt; <a href="#">core</a> &gt; <a href="#">dev</a> &gt; <a href="index.html">@TraceSpectra</a> &gt; specgram2.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for GISMO/core/dev/@TraceSpectra&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>specgram2
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>SPECGRAM2 - plots spectrograms of waveforms with waveform along top</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function h = specgram2(s, T, varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">SPECGRAM2 - plots spectrograms of waveforms with waveform along top
  h = specgram2(spectralobject, waveforms) generates a spectrogram from
  the waveform(s), overwriting the current figure.  The waveform will be
  displayed along the top of the spectrogram. The return value is a handle
  to the spectrogram, and is optional.

  The spectrograms will be created in the same shape as the passed
  waveforms.  ie, if W is a 2x3 matrix of waveforms, then
  specgram2(spectralobject,W) will generate a 2x3 plot of spectra.

  Many additional behaviors can be modified through the passing of
  additional parameters, as listed further below.  These parameters are
  always passed in pairs, as such:

  specgram2(spectralobject, waveforms,'PARAM1',VALUE1,...,'PARAMn',VALUEn)
    Any number of these parameters may be passed to specgram2.

  specgram2(..., 'axis', AXIS_HANDLE)
    Specify the axis AXIS_HANDLE within which the spectrogram will be
    generated.  The boundary of the axis becomes the boundary for the
    entire spectra plot.  For a matrix of waveforms, this area is
    subdivided into NxM subplots, where N and M are the size of the
    waveform matrix.

  specgram2(..., 'xunit', XUNIT)
    Spedifies the x-unit scale to be used with the spectrogram.  The
    default unit is 'seconds'.
    valid xunits:
     'seconds','minutes','hours','days','doy' (day of year),and 'date'

  specgram2(..., 'colormap', ALTERNATEMAP)
    Instead of using the default colormap, any colormap may be used.  An
    alternate way of setting the global map is by using the SETMAP
    function.  ALTERNATEMAP will either be a name (eg. grayscale) or an
    Nx3 numeric. Type HELP GRAPH3D to see additional useful colormaps.


  specgram2(..., 'colorbar', COLORBAR_OPTION)
    Generates a spectrogram from the waveform and uses a specific map
    valid COLORBAR_OPTION values: 'horiz' (default),'vert','none',
      'HORIZ' places a single colorbar below all plots
      'VERT' places a single colorbar to the right of all plots
      'NONE' supresses the colorbar placement

  specgram2(..., 'yscale', YSCALE)
    Choosing 'log' Allows the y-axis to be generated on a log-frequency
    scale, with uneven vertical cell spacing.  The default value is
    'normal', and provides the standard spectrogram view.
    valid yscales: 'normal', 'log' (see NOTE below)

    NOTE: In order to use the log scale, UIMAGESC needs to be available on
    the matlab path.  This routine was created by Frederic Moisy, and may
    be downloaded from the maltabcentral fileexchange (File ID: 11368).
    If this routine is not found,then the original spectrogram will be
    created.

  specgram2(..., 'fontsize', FONTSIZE)
    Specify the font size for a spectrogram.  The default font size is 8.

  specgram2(..., 'innerLabels', SHOWINNERLABELS)
    Suppress the labling of the inside graphs by setting SHOWINNERLABELS
    to false.  If this is false, then the frequency label only shows on
    the leftmost spectrograms, and the X-unit label only shows on the
    bottommost spectrograms.

  Example 1:
    % The following plots a waveform using an alternate mapping, an xunit of
    % of 'hours', and with the y-axis plotted using a log scale.
    specgram2(spectralobject, waveform,...
      'colormap', alternateMap,'xunit','h','yscale','log')


  Example 2:
    % create an arbitrary subplot, and then plot multiple spectra
    a = subplot(3,2,1);
    specgram2(spectralobject,waves,'axis',a); % waves is an NxM waveform

   See also SPECTRALOBJECT/SPECGRAM</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="../../../../GISMO/core/@Catalog/disp.html" class="code" title="function disp(obj, showall)">disp</a>	CATALOG.DISP Display Catalog object</li><li><a href="../../../../GISMO/core/@Catalog/plot.html" class="code" title="function plot(catalogObject, varargin)">plot</a>	CATALOG.PLOT Plot hypocenters in map view and cross-sections</li><li><a href="../../../../GISMO/core/@correlation/get.html" class="code" title="function val = get(c,prop_name)">get</a>	GET - Get correlation properties</li><li><a href="../../../../GISMO/core/@correlation/plot.html" class="code" title="function plot(c,varargin)">plot</a>	PLOT(C) plots waveforms stored in a correlation object. Traces are</li><li><a href="../../../../GISMO/core/@correlation/set.html" class="code" title="function c = set(c, prop_name, val)">set</a>	SET Set properties for correlation object</li><li><a href="../../../../GISMO/core/@datasource/disp.html" class="code" title="function disp(ds)">disp</a>	DISP Datasource disp overloaded operator</li><li><a href="../../../../GISMO/core/@datasource/get.html" class="code" title="function val = get(ds, propertyname)">get</a>	</li><li><a href="../../../../GISMO/core/@drumplot/get.html" class="code" title="function val = get(h,prop_name)">get</a>	GET: Get drumplot properties</li><li><a href="../../../../GISMO/core/@drumplot/plot.html" class="code" title="function varargout = plot(h)">plot</a>	PLOT: Drumplot plotting function. A drumplot object (h) contains no</li><li><a href="../../../../GISMO/core/@drumplot/set.html" class="code" title="function h = set(h,varargin)">set</a>	SET: Set drumplot properties</li><li><a href="../../../../GISMO/core/@filterobject/disp.html" class="code" title="function disp(f)">disp</a>	DISP - Filterobject disp overloaded operator</li><li><a href="../../../../GISMO/core/@filterobject/get.html" class="code" title="function val = get(f, prop_name)">get</a>	GET - Get filterobject properties</li><li><a href="../../../../GISMO/core/@filterobject/set.html" class="code" title="function f = set(f, varargin)">set</a>	SET - Set filterobject properties</li><li><a href="../../../../GISMO/core/@rsam/plot.html" class="code" title="function handlePlot = plot(rsam_vector, varargin)">plot</a>	RSAM/PLOT plot rsam data</li><li><a href="../../../../GISMO/core/@scnlobject/disp.html" class="code" title="function disp(sncl)">disp</a>	DISP - scnl disp overloaded operator</li><li><a href="../../../../GISMO/core/@scnlobject/get.html" class="code" title="function stuff = get(scnl, prop_name)">get</a>	GET for the scnl object</li><li><a href="../../../../GISMO/core/@scnlobject/set.html" class="code" title="function scnl = set(scnl, varargin)">set</a>	SET - Set properties for scnlobject</li><li><a href="../../../../GISMO/core/@spectralobject/disp.html" class="code" title="function disp(s)">disp</a>	DISP - spectralobject disp overloaded operator</li><li><a href="../../../../GISMO/core/@spectralobject/get.html" class="code" title="function out = get(s, prop_name)">get</a>	GET - Get properties for spectralobject</li><li><a href="../../../../GISMO/core/@spectralobject/set.html" class="code" title="function s = set(s, varargin)">set</a>	SET - Set properties for spectralobject</li><li><a href="../../../../GISMO/core/@spectralobject/specgram.html" class="code" title="function h = specgram(s, ws, varargin)">specgram</a>	SPECGRAM - plots spectrogram of waveforms</li><li><a href="../../../../GISMO/core/@spectralobject/specgram2.html" class="code" title="function specgram2(s, ws, varargin)">specgram2</a>	SPECGRAM2 - plots spectrograms of waveforms with waveform along top</li><li><a href="../../../../GISMO/core/@threecomp/disp.html" class="code" title="function disp(TC)">disp</a>	DISP Display threecomp object</li><li><a href="../../../../GISMO/core/@threecomp/get.html" class="code" title="function val = get(TC,varargin)">get</a>	GET    Get threecomp object properties.</li><li><a href="../../../../GISMO/core/@threecomp/isempty.html" class="code" title="function TF = isempty(TC)">isempty</a>	ISEMPTY Display threecomp object</li><li><a href="../../../../GISMO/core/@threecomp/plot.html" class="code" title="function varargout = plot(TC, varargin)">plot</a>	PLOT plots a threecomp object</li><li><a href="../../../../GISMO/core/@threecomp/set.html" class="code" title="function TC = set(TC, fieldName, val)">set</a>	SET inserts properties for threecomp object</li><li><a href="../../../../GISMO/core/@waveform/disp.html" class="code" title="function disp(w)">disp</a>	DISP Waveform disp overloaded operator</li><li><a href="../../../../GISMO/core/@waveform/get.html" class="code" title="function val = get(w,prop_name)">get</a>	GET Get waveform properties</li><li><a href="../../../../GISMO/core/@waveform/isempty.html" class="code" title="function TF = isempty(w)">isempty</a>	ISEMPTY returns TRUE if waveform contains no data</li><li><a href="../../../../GISMO/core/@waveform/plot.html" class="code" title="function varargout = plot(w, varargin)">plot</a>	PLOT plots a waveform object</li><li><a href="../../../../GISMO/core/@waveform/set.html" class="code" title="function w = set(w, varargin)">set</a>	SET Set properties for waveform object(s)</li><li><a href="../../../../GISMO/core/dev/@NewCorrelation/disp.html" class="code" title="function disp(c)">disp</a>	CORRELATION/DISPLAY Command window display of a correlation object</li><li><a href="../../../../GISMO/core/dev/@NewCorrelation/get.html" class="code" title="function val = get(c,prop_name)">get</a>	GET - Get correlation properties</li><li><a href="../../../../GISMO/core/dev/@NewCorrelation/plot.html" class="code" title="function plot(c,varargin)">plot</a>	PLOT(C) plots waveforms stored in a correlation object. Traces are</li><li><a href="../../../../GISMO/core/dev/@NewCorrelation/set.html" class="code" title="function c = set(c, prop_name, val)">set</a>	SET Set properties for correlation object</li><li><a href="../../../../GISMO/core/dev/@SeismicTrace/SeismicTrace.html" class="code" title="">SeismicTrace</a>	</li><li><a href="../../../../GISMO/core/dev/@SeismicTrace/disp.html" class="code" title="function disp(T)">disp</a>	disp   Display information about SeismicTrace(s)</li><li><a href="../../../../GISMO/core/dev/@SeismicTrace/plot.html" class="code" title="function varargout = plot(T, varargin)">plot</a>	plot   plots a SeismicTrace</li><li><a href="parseSpecgramInputs.html" class="code" title="function p = parseSpecgramInputs(me, cellOfArgs)">parseSpecgramInputs</a>	parseSpecgramInputs   handles inputs for specgram functions</li><li><a href="specgram.html" class="code" title="function h = specgram(s, T, varargin)">specgram</a>	specgram - plots spectrogram of traces</li><li><a href="specgram2.html" class="code" title="function h = specgram2(s, T, varargin)">specgram2</a>	SPECGRAM2 - plots spectrograms of waveforms with waveform along top</li><li><a href="../../../../GISMO/deprecated/@helicorder/disp.html" class="code" title="function disp(h)">disp</a>	DISP: Helicorder disp overloaded operator</li><li><a href="../../../../GISMO/deprecated/@helicorder/get.html" class="code" title="function val = get(h,prop_name)">get</a>	GET: Get helicorder properties</li><li><a href="../../../../GISMO/deprecated/@helicorder/set.html" class="code" title="function h = set(h,varargin)">set</a>	SET: Set helicorder properties</li><li><a href="../../../../GISMO/deprecated/fft_tools/+wf_fft/plot.html" class="code" title="function plot(w)">plot</a>	PLOT plot fourier transform of a waveform</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="../../../../GISMO/applications/uispecgram.html" class="code" title="function varargout = uispecgram(varargin)">uispecgram</a>	UISPECGRAM M-file for uispecgram.fig</li><li><a href="../../../../GISMO/core/@spectralobject/specgram2.html" class="code" title="function specgram2(s, ws, varargin)">specgram2</a>	SPECGRAM2 - plots spectrograms of waveforms with waveform along top</li><li><a href="TraceSpectra.html" class="code" title="">TraceSpectra</a>	</li><li><a href="specgram2.html" class="code" title="function h = specgram2(s, T, varargin)">specgram2</a>	SPECGRAM2 - plots spectrograms of waveforms with waveform along top</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="#_sub1" class="code">function wigPos = wigglePosition(pos)</a></li><li><a href="#_sub2" class="code">function specPos = spectraPosition(pos)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function h = specgram2(s, T, varargin)</a>
0002    <span class="comment">%SPECGRAM2 - plots spectrograms of waveforms with waveform along top</span>
0003    <span class="comment">%  h = specgram2(spectralobject, waveforms) generates a spectrogram from</span>
0004    <span class="comment">%  the waveform(s), overwriting the current figure.  The waveform will be</span>
0005    <span class="comment">%  displayed along the top of the spectrogram. The return value is a handle</span>
0006    <span class="comment">%  to the spectrogram, and is optional.</span>
0007    <span class="comment">%</span>
0008    <span class="comment">%  The spectrograms will be created in the same shape as the passed</span>
0009    <span class="comment">%  waveforms.  ie, if W is a 2x3 matrix of waveforms, then</span>
0010    <span class="comment">%  specgram2(spectralobject,W) will generate a 2x3 plot of spectra.</span>
0011    <span class="comment">%</span>
0012    <span class="comment">%  Many additional behaviors can be modified through the passing of</span>
0013    <span class="comment">%  additional parameters, as listed further below.  These parameters are</span>
0014    <span class="comment">%  always passed in pairs, as such:</span>
0015    <span class="comment">%</span>
0016    <span class="comment">%  specgram2(spectralobject, waveforms,'PARAM1',VALUE1,...,'PARAMn',VALUEn)</span>
0017    <span class="comment">%    Any number of these parameters may be passed to specgram2.</span>
0018    <span class="comment">%</span>
0019    <span class="comment">%  specgram2(..., 'axis', AXIS_HANDLE)</span>
0020    <span class="comment">%    Specify the axis AXIS_HANDLE within which the spectrogram will be</span>
0021    <span class="comment">%    generated.  The boundary of the axis becomes the boundary for the</span>
0022    <span class="comment">%    entire spectra plot.  For a matrix of waveforms, this area is</span>
0023    <span class="comment">%    subdivided into NxM subplots, where N and M are the size of the</span>
0024    <span class="comment">%    waveform matrix.</span>
0025    <span class="comment">%</span>
0026    <span class="comment">%  specgram2(..., 'xunit', XUNIT)</span>
0027    <span class="comment">%    Spedifies the x-unit scale to be used with the spectrogram.  The</span>
0028    <span class="comment">%    default unit is 'seconds'.</span>
0029    <span class="comment">%    valid xunits:</span>
0030    <span class="comment">%     'seconds','minutes','hours','days','doy' (day of year),and 'date'</span>
0031    <span class="comment">%</span>
0032    <span class="comment">%  specgram2(..., 'colormap', ALTERNATEMAP)</span>
0033    <span class="comment">%    Instead of using the default colormap, any colormap may be used.  An</span>
0034    <span class="comment">%    alternate way of setting the global map is by using the SETMAP</span>
0035    <span class="comment">%    function.  ALTERNATEMAP will either be a name (eg. grayscale) or an</span>
0036    <span class="comment">%    Nx3 numeric. Type HELP GRAPH3D to see additional useful colormaps.</span>
0037    <span class="comment">%</span>
0038    <span class="comment">%</span>
0039    <span class="comment">%  specgram2(..., 'colorbar', COLORBAR_OPTION)</span>
0040    <span class="comment">%    Generates a spectrogram from the waveform and uses a specific map</span>
0041    <span class="comment">%    valid COLORBAR_OPTION values: 'horiz' (default),'vert','none',</span>
0042    <span class="comment">%      'HORIZ' places a single colorbar below all plots</span>
0043    <span class="comment">%      'VERT' places a single colorbar to the right of all plots</span>
0044    <span class="comment">%      'NONE' supresses the colorbar placement</span>
0045    <span class="comment">%</span>
0046    <span class="comment">%  specgram2(..., 'yscale', YSCALE)</span>
0047    <span class="comment">%    Choosing 'log' Allows the y-axis to be generated on a log-frequency</span>
0048    <span class="comment">%    scale, with uneven vertical cell spacing.  The default value is</span>
0049    <span class="comment">%    'normal', and provides the standard spectrogram view.</span>
0050    <span class="comment">%    valid yscales: 'normal', 'log' (see NOTE below)</span>
0051    <span class="comment">%</span>
0052    <span class="comment">%    NOTE: In order to use the log scale, UIMAGESC needs to be available on</span>
0053    <span class="comment">%    the matlab path.  This routine was created by Frederic Moisy, and may</span>
0054    <span class="comment">%    be downloaded from the maltabcentral fileexchange (File ID: 11368).</span>
0055    <span class="comment">%    If this routine is not found,then the original spectrogram will be</span>
0056    <span class="comment">%    created.</span>
0057    <span class="comment">%</span>
0058    <span class="comment">%  specgram2(..., 'fontsize', FONTSIZE)</span>
0059    <span class="comment">%    Specify the font size for a spectrogram.  The default font size is 8.</span>
0060    <span class="comment">%</span>
0061    <span class="comment">%  specgram2(..., 'innerLabels', SHOWINNERLABELS)</span>
0062    <span class="comment">%    Suppress the labling of the inside graphs by setting SHOWINNERLABELS</span>
0063    <span class="comment">%    to false.  If this is false, then the frequency label only shows on</span>
0064    <span class="comment">%    the leftmost spectrograms, and the X-unit label only shows on the</span>
0065    <span class="comment">%    bottommost spectrograms.</span>
0066    <span class="comment">%</span>
0067    <span class="comment">%  Example 1:</span>
0068    <span class="comment">%    % The following plots a waveform using an alternate mapping, an xunit of</span>
0069    <span class="comment">%    % of 'hours', and with the y-axis plotted using a log scale.</span>
0070    <span class="comment">%    specgram2(spectralobject, waveform,...</span>
0071    <span class="comment">%      'colormap', alternateMap,'xunit','h','yscale','log')</span>
0072    <span class="comment">%</span>
0073    <span class="comment">%</span>
0074    <span class="comment">%  Example 2:</span>
0075    <span class="comment">%    % create an arbitrary subplot, and then plot multiple spectra</span>
0076    <span class="comment">%    a = subplot(3,2,1);</span>
0077    <span class="comment">%    specgram2(spectralobject,waves,'axis',a); % waves is an NxM waveform</span>
0078    <span class="comment">%</span>
0079    <span class="comment">%   See also SPECTRALOBJECT/SPECGRAM</span>
0080    
0081    <span class="keyword">if</span> ~isa(T,<span class="string">'TraceData'</span>)
0082             <span class="keyword">try</span>
0083                T = <a href="../../../../GISMO/core/dev/@SeismicTrace/SeismicTrace.html" class="code" title="">SeismicTrace</a>(T);
0084                <a href="../../../../GISMO/core/@Catalog/disp.html" class="code" title="function disp(obj, showall)">disp</a>(<span class="string">'successfully converted to a SeismicTrace'</span>);
0085             <span class="keyword">catch</span> er
0086       error(<span class="string">'Spectralobject:specgram2:invalidArgument'</span>,<span class="string">'Should work on a trace (ex. TraceData, SeismicTrace), not a %s'</span>,class(T));
0087             <span class="keyword">end</span>
0088    <span class="keyword">end</span>
0089    
0090    <span class="comment">%% search for relevent property pairs passed as parameters</span>
0091    p = <a href="parseSpecgramInputs.html" class="code" title="function p = parseSpecgramInputs(me, cellOfArgs)">parseSpecgramInputs</a>(s, varargin);
0092    
0093    <span class="comment">%% figure out exactly WHERE to plot the spectrogram(s)</span>
0094    <span class="comment">%find out area(axis) in which the spectrograms will be plotted</span>
0095    clabel= <span class="string">'Relative Amplitude  (dB)'</span>;
0096    
0097    <span class="keyword">if</span> p.Results.axis == 0,
0098       clf;
0099       pos = <a href="../../../../GISMO/core/@correlation/get.html" class="code" title="function val = get(c,prop_name)">get</a>(gca,<span class="string">'position'</span>);
0100    <span class="keyword">else</span>
0101       pos = <a href="../../../../GISMO/core/@correlation/get.html" class="code" title="function val = get(c,prop_name)">get</a>(p.Results.axis,<span class="string">'position'</span>);
0102    <span class="keyword">end</span>
0103    <span class="keyword">if</span> ~<a href="../../../../GISMO/core/@threecomp/isempty.html" class="code" title="function TF = isempty(TC)">isempty</a>(p.Results.position)
0104       pos = p.Results.position;
0105    <span class="keyword">end</span>
0106       
0107    <span class="comment">%% If there are multiple waveforms...</span>
0108    <span class="comment">% subdivide the axis and loop through specgram2 with individual waveforms.</span>
0109    <span class="keyword">if</span> numel(T) &gt; 1
0110       <span class="keyword">if</span> p.Results.axis== 0,
0111          myaxis = gca;
0112       <span class="keyword">end</span>
0113       <span class="comment">%create the colorbar if desired</span>
0114       TraceSpectra.createcolorbar(s,p.Results.colorbar, clabel, p.Results.fontsize);
0115       h = TraceSpectra.subdivide_axes(myaxis, size(T));
0116       <span class="comment">% remainingproperties = TraceSpectra.property2varargin(proplist);</span>
0117       remainingproperties = TraceSpectra.buildParameterList( p.Unmatched);
0118       <span class="keyword">for</span> n=1:numel(h)
0119          keepYlabel =  ~p.Results.innerlabels || (n &lt;= size(h,1));
0120          keepXlabel = ~p.Results.innerlabels || (mod(n,size(h,2))==0);
0121          <a href="specgram2.html" class="code" title="function h = specgram2(s, T, varargin)">specgram2</a>(s,T(n),<span class="keyword">...</span>
0122             <span class="string">'xunit'</span>,p.Results.xunit,<span class="keyword">...</span>
0123             <span class="string">'axis'</span>,h(n),<span class="keyword">...</span>
0124             <span class="string">'fontsize'</span>,p.Results.fontsize,<span class="keyword">...</span>
0125             <span class="string">'useXlabel'</span>,keepXlabel,<span class="keyword">...</span>
0126             <span class="string">'useYlabel'</span>,keepYlabel,<span class="keyword">...</span>
0127             <span class="string">'colorbar'</span>,<span class="string">'none'</span>,<span class="keyword">...</span>
0128             remainingproperties{:});
0129       <span class="keyword">end</span>
0130       <span class="keyword">return</span>
0131    <span class="keyword">end</span>
0132    
0133    <span class="comment">%% Plot the spectrogram with a wiggle on top and colorbar below</span>
0134    
0135    <span class="comment">%plot the wiggle</span>
0136    ax_wiggle = subplot(<span class="string">'position'</span>,<a href="#_sub1" class="code" title="subfunction wigPos = wigglePosition(pos)">wigglePosition</a>(pos));
0137    <a href="../../../../GISMO/core/@Catalog/plot.html" class="code" title="function plot(catalogObject, varargin)">plot</a>(T,<span class="string">'xunit'</span>,p.Results.xunit,<span class="string">'autoscale'</span>,true,<span class="string">'fontsize'</span>,p.Results.fontsize);
0138    
0139    <span class="comment">% make the axis tight, and keep axis info for later use with spectra</span>
0140    axis(ax_wiggle,<span class="string">'tight'</span>);
0141    xAxisLims = <a href="../../../../GISMO/core/@correlation/get.html" class="code" title="function val = get(c,prop_name)">get</a>(ax_wiggle,<span class="string">'xlim'</span>);
0142    ticnos = <a href="../../../../GISMO/core/@correlation/get.html" class="code" title="function val = get(c,prop_name)">get</a>(ax_wiggle,<span class="string">'xtick'</span>);
0143    
0144    <span class="comment">%plot the spectra</span>
0145    ax_spectra = subplot(<span class="string">'position'</span>,<a href="#_sub2" class="code" title="subfunction specPos = spectraPosition(pos)">spectraPosition</a>(pos));
0146    additionalParams = TraceSpectra.buildParameterList( p.Unmatched);
0147    <a href="specgram.html" class="code" title="function h = specgram(s, T, varargin)">specgram</a>(s,T,<span class="keyword">...</span>
0148       <span class="string">'xunit'</span>,p.Results.xunit,<span class="keyword">...</span>
0149       <span class="string">'fontsize'</span>,p.Results.fontsize,<span class="keyword">...</span>
0150       <span class="string">'yscale'</span>,p.Results.yscale,<span class="keyword">...</span>
0151       <span class="string">'colorbar'</span>,<span class="string">'none'</span>,<span class="keyword">...</span>
0152       <span class="string">'axis'</span>,ax_spectra,<span class="keyword">...</span>
0153       <span class="string">'suppressXlabel'</span>,p.Results.useXlabel,<span class="keyword">...</span>
0154       <span class="string">'suppressYlabel'</span>,p.Results.useYlabel,<span class="keyword">...</span>
0155       additionalParams{:});
0156    
0157    <span class="comment">%make the axis match exactly with the waveform above</span>
0158    <a href="../../../../GISMO/core/@correlation/set.html" class="code" title="function c = set(c, prop_name, val)">set</a>(ax_spectra,<span class="string">'xtick'</span>,ticnos);
0159    <span class="keyword">if</span> ~strcmpi(p.Results.yscale,<span class="string">'log'</span>)
0160       <span class="comment">% axis scaling doesn't work quite right at a log scale</span>
0161       xlim(ax_spectra, xAxisLims);
0162    <span class="keyword">end</span>
0163    
0164    title(<span class="string">''</span>); <span class="comment">%clear the title</span>
0165    
0166    <span class="comment">%create the colorbar if desired</span>
0167    TraceSpectra.createcolorbar(s,p.Results.colorbar, clabel, p.Results.fontsize);
0168 <span class="keyword">end</span>
0169 
0170 <a name="_sub1" href="#_subfunctions" class="code">function wigPos = wigglePosition(pos)</a>
0171    <span class="comment">% wigglePosition   wiggle occupies the top 15% of the axis</span>
0172    <span class="comment">% pos = [ left, bottom, width, height ]</span>
0173    <span class="comment">% wavepos = [ left, bottom + height * 0.85,  width , height * 0.15] ;</span>
0174    wigPos = pos .* [1, 1, 1, 0.15] + [0,  pos(4) * 0.85, 0, 0] ;
0175 <span class="keyword">end</span>
0176 
0177 <a name="_sub2" href="#_subfunctions" class="code">function specPos = spectraPosition(pos)</a>
0178    <span class="comment">%spectraPosition   spectra occupies the bottom 85% of the axis</span>
0179    specPos = pos .* [1, 1, 1, 0.85 ];
0180 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Wed 12-Oct-2016 17:36:30 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>