<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of importPlates</title>
  <meta name="keywords" content="importPlates">
  <meta name="description" content="IMPORTPLATES Import numeric data from a text file as column vectors.">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="../../../index.html">GISMO</a> &gt; <a href="#">core</a> &gt; <a href="../index.html">+Catalog</a> &gt; <a href="index.html">+plotEarthquakes</a> &gt; importPlates.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for GISMO/core/+Catalog/+plotEarthquakes&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>importPlates
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>IMPORTPLATES Import numeric data from a text file as column vectors.</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function [lat,lon] = importPlates(filename, startRow, endRow) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment">IMPORTPLATES Import numeric data from a text file as column vectors.
   [LAT,LON] = IMPORTPLATES(FILENAME) Reads data from text file FILENAME for
   the default selection.

   [LAT,LON] = IMPORTPLATES(FILENAME, STARTROW, ENDROW) Reads data from rows
   STARTROW through ENDROW of text file FILENAME.

 Example:
   [lat,lon] = importPlates('All_boundaries.txt',2, 12377);

    See also TEXTSCAN.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
<li><a href="../../../../GISMO/core/@threecomp/isempty.html" class="code" title="function TF = isempty(TC)">isempty</a>	ISEMPTY Display threecomp object</li><li><a href="../../../../GISMO/core/@waveform/isempty.html" class="code" title="function TF = isempty(w)">isempty</a>	ISEMPTY returns TRUE if waveform contains no data</li></ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [lat,lon] = importPlates(filename, startRow, endRow)</a>
0002 <span class="comment">%IMPORTPLATES Import numeric data from a text file as column vectors.</span>
0003 <span class="comment">%   [LAT,LON] = IMPORTPLATES(FILENAME) Reads data from text file FILENAME for</span>
0004 <span class="comment">%   the default selection.</span>
0005 <span class="comment">%</span>
0006 <span class="comment">%   [LAT,LON] = IMPORTPLATES(FILENAME, STARTROW, ENDROW) Reads data from rows</span>
0007 <span class="comment">%   STARTROW through ENDROW of text file FILENAME.</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% Example:</span>
0010 <span class="comment">%   [lat,lon] = importPlates('All_boundaries.txt',2, 12377);</span>
0011 <span class="comment">%</span>
0012 <span class="comment">%    See also TEXTSCAN.</span>
0013 
0014 <span class="comment">% Auto-generated by MATLAB on 2015/01/23 11:51:24</span>
0015 
0016 <span class="comment">%% Initialize variables.</span>
0017 <span class="keyword">if</span> nargin&lt;=2
0018     startRow = 2;
0019     endRow = inf;
0020 <span class="keyword">end</span>
0021 
0022 <span class="comment">%% Read columns of data as strings:</span>
0023 <span class="comment">% For more information, see the TEXTSCAN documentation.</span>
0024 formatSpec = <span class="string">'%9s%s%[^\n\r]'</span>;
0025 
0026 <span class="comment">%% Open the text file.</span>
0027 fileID = fopen(filename,<span class="string">'r'</span>);
0028 
0029 <span class="comment">%% Read columns of data according to format string.</span>
0030 <span class="comment">% This call is based on the structure of the file used to generate this</span>
0031 <span class="comment">% code. If an error occurs for a different file, try regenerating the code</span>
0032 <span class="comment">% from the Import Tool.</span>
0033 dataArray = textscan(fileID, formatSpec, endRow(1)-startRow(1)+1, <span class="string">'Delimiter'</span>, <span class="string">''</span>, <span class="string">'WhiteSpace'</span>, <span class="string">''</span>, <span class="string">'HeaderLines'</span>, startRow(1)-1, <span class="string">'ReturnOnError'</span>, false);
0034 <span class="keyword">for</span> block=2:length(startRow)
0035     frewind(fileID);
0036     dataArrayBlock = textscan(fileID, formatSpec, endRow(block)-startRow(block)+1, <span class="string">'Delimiter'</span>, <span class="string">''</span>, <span class="string">'WhiteSpace'</span>, <span class="string">''</span>, <span class="string">'HeaderLines'</span>, startRow(block)-1, <span class="string">'ReturnOnError'</span>, false);
0037     <span class="keyword">for</span> col=1:length(dataArray)
0038         dataArray{col} = [dataArray{col};dataArrayBlock{col}];
0039     <span class="keyword">end</span>
0040 <span class="keyword">end</span>
0041 
0042 <span class="comment">%% Close the text file.</span>
0043 fclose(fileID);
0044 
0045 <span class="comment">%% Convert the contents of columns containing numeric strings to numbers.</span>
0046 <span class="comment">% Replace non-numeric strings with NaN.</span>
0047 raw = repmat({<span class="string">''</span>},length(dataArray{1}),length(dataArray)-1);
0048 <span class="keyword">for</span> col=1:length(dataArray)-1
0049     raw(1:length(dataArray{col}),col) = dataArray{col};
0050 <span class="keyword">end</span>
0051 numericData = NaN(size(dataArray{1},1),size(dataArray,2));
0052 
0053 <span class="keyword">for</span> col=[1,2]
0054     <span class="comment">% Converts strings in the input cell array to numbers. Replaced non-numeric</span>
0055     <span class="comment">% strings with NaN.</span>
0056     rawData = dataArray{col};
0057     <span class="keyword">for</span> row=1:size(rawData, 1);
0058         <span class="comment">% Create a regular expression to detect and remove non-numeric prefixes and</span>
0059         <span class="comment">% suffixes.</span>
0060         regexstr = <span class="string">'(?&lt;prefix&gt;.*?)(?&lt;numbers&gt;([-]*(\d+[\,]*)+[\.]{0,1}\d*[eEdD]{0,1}[-+]*\d*[i]{0,1})|([-]*(\d+[\,]*)*[\.]{1,1}\d+[eEdD]{0,1}[-+]*\d*[i]{0,1}))(?&lt;suffix&gt;.*)'</span>;
0061         <span class="keyword">try</span>
0062             result = regexp(rawData{row}, regexstr, <span class="string">'names'</span>);
0063             numbers = result.numbers;
0064             
0065             <span class="comment">% Detected commas in non-thousand locations.</span>
0066             invalidThousandsSeparator = false;
0067             <span class="keyword">if</span> any(numbers==<span class="string">','</span>);
0068                 thousandsRegExp = <span class="string">'^\d+?(\,\d{3})*\.{0,1}\d*$'</span>;
0069                 <span class="keyword">if</span> <a href="../../../../GISMO/core/@threecomp/isempty.html" class="code" title="function TF = isempty(TC)">isempty</a>(regexp(thousandsRegExp, <span class="string">','</span>, <span class="string">'once'</span>));
0070                     numbers = NaN;
0071                     invalidThousandsSeparator = true;
0072                 <span class="keyword">end</span>
0073             <span class="keyword">end</span>
0074             <span class="comment">% Convert numeric strings to numbers.</span>
0075             <span class="keyword">if</span> ~invalidThousandsSeparator;
0076                 numbers = textscan(strrep(numbers, <span class="string">','</span>, <span class="string">''</span>), <span class="string">'%f'</span>);
0077                 numericData(row, col) = numbers{1};
0078                 raw{row, col} = numbers{1};
0079             <span class="keyword">end</span>
0080         <span class="keyword">catch</span> me
0081         <span class="keyword">end</span>
0082     <span class="keyword">end</span>
0083 <span class="keyword">end</span>
0084 
0085 
0086 <span class="comment">%% Replace non-numeric cells with NaN</span>
0087 R = cellfun(@(x) ~isnumeric(x) &amp;&amp; ~islogical(x),raw); <span class="comment">% Find non-numeric cells</span>
0088 raw(R) = {NaN}; <span class="comment">% Replace non-numeric cells</span>
0089 
0090 <span class="comment">%% Allocate imported array to column variable names</span>
0091 lat = cell2mat(raw(:, 1));
0092 lon = cell2mat(raw(:, 2));
0093 
0094</pre></div>
<hr><address>Generated on Wed 12-Oct-2016 17:36:30 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>