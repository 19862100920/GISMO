<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of plot</title>
  <meta name="keywords" content="plot">
  <meta name="description" content="PLOT(C) plots waveforms stored in a correlation object. Traces are">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../../../index.html">Home</a> &gt;  <a href="#">gismotools</a> &gt; <a href="../../index.html">GISMO</a> &gt; <a href="../index.html">classes</a> &gt; <a href="index.html">@correlation</a> &gt; plot.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../../../index.html"><img alt="<" border="0" src="../../../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for gismotools/GISMO/classes/@correlation&nbsp;<img alt=">" border="0" src="../../../../right.png"></a></td></tr></table>-->

<h1>plot
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>PLOT(C) plots waveforms stored in a correlation object. Traces are</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="box"><strong>function plot(c,varargin) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> PLOT(C) plots waveforms stored in a correlation object. Traces are
 aligned by their trigger times. For optimum correlation use ADJUSTTRIG
 first. Trace amplitudes are normalized before plotting.

 PLOT(C,'wiggle') plots a wiggle trace (default for &lt; 100 traces)

 PLOT(C,'wiggle',SCALE) plots wiggle traces with relative amplitudes
 of SCALE (default SCALE is 1.0 - no overlap for adjacent traces)

 PLOT(C,'wiggle',SCALE,PERM) plots the wiggle traces as specified and 
 ordered by the PERM vector. PERM may be a subset of the full list of
 trace, a reordering of the traces, or both. The default behavior is to
 plot traces as they appear in the TRIG field. One common use is to use
 the PERM vector to plot traces in the same order they appear in a
 dendrogram plot. For example:
       [H,tmp,perm] = dendrogram(c, ...);
       plot(c,'wig',1,perm);

 PLOT(C,'raw',...) same as 'wig' option except that traces are not
 normalized to an equal amplitude before plotting. They are scaled to the
 mean of the maximum trace amplitude. Scaling can be further refined 
 with the SCALE factor and/or by using the NORM function prior to plotting.

 PLOT(C,'shaded',...) plots shaded waveforms. (default for &gt;= 100 traces) 
 The 'wiggle' option is not conducive to displays of more than about 100
 traces. The 'shaded' option is recommended for large datasets.  Plot
 colors can be modified with the COLORMAP command. Same options are 
 available as for the wiggle plots.

 PLOT(C,'overlay',...) overlays the aligned traces on one another. The
 stack of the traces is plotted in bold on top. If traces have not been
 cropped prior to plotting, beware of odd effects toward the ends of the
 stacked traces. Trace amplitudes are not normalized prior to plotting 
 (like 'raw'). Use NORM if normalization is necessary prior to plotting.
 
 PLOT(C,'interfer') plot shaded images of the correlation values and/or
 lag times from behind the traces. See HELP INTERFEROGRAM for more
 information on where this data comes from and how it is stored (a bit ad
 hoc). Note that no trace normalization is applied to interferograms. In
 many cases the user will choose to run the NORM command before plotting.
 By default PLOT(C,'interfer') is the same as PLOT(C,'interfer',1,'LAG').
 
 PLOT(C,'interfer',SCALE,'CORR') plots a shaded image of the correlation
 values from the interferogram routine behind the traces. Lag times are
 ignored in this style of plot.

 PLOT(C,'interfer',SCALE,'LAG',RANGE) plots traces on a shaded image that
 is a function of both the lag time and the correlation value. The color
 scale ranges from -RANGE to +RANGE seconds. If RANGE is not included, then
 it is set to 0.03 seconds. As the correlation value drops, the colors are
 increasingly faded. Regions of the waveforms that correlate at less than
 0.6 are considered unreliable and are not colored at all. For example,
 bright red indicates a waveform segment that correlates very well but is
 delayed relative to the reference trace. Faded blue indicates moderate
 correlation and advanced arrival. Yellow is no time shift. White
 signifies poor correlation (in which case the lag time is meaningless).

 PLOT(C,'sample',...) same as wiggle plot except that individual sample
 points are plotted. Really this is only useful for debugging.

 PLOT(C,'corr') plots an image of the correlation matrix. Requires 
 CORR field to be filed. 

 PLOT(C,'lag') plots an image of the lag matrix. Requires LAG field to be
 filled.

 PLOT(C,'stat') plots the delay time statistics for each trace. Requires STAT
 field to be filled. If STAT field is not filled, PLOT(C,'STAT') will call
 GETSTAT. The resulting values will be used for plotting but will *not* be
 saved into C. 

 PLOT(D,'den') plots a dendrogram image. Requires the LINK field to be
 filled (see correlation/linkage).

 PLOT(C,'event') This routine has been deprecated and will be removed in a
 future release. Use the occurence plot routine instead. The event routine
 plots the time evolution of each event cluster together with a stack of
 all of the traces in that cluster. No normalization is applied to the
 traces before stacking. Requires the CLUST property be filled.

 PLOT(C,'event',SCALE)
 PLOT(C,'event',SCALE,CLUSTERS)
 Same as above except relative trace amplitudes are scaled by SCALE.
 Default is 1. If specified, CLUSTERS states how many clusters to include 
 in the analysis. That is, if CLUSTERS is 5, then the 5 largest clusters
 are included in the plots. The default value of CLUSTERS is 4.
 Example - plot the 3 largest clusters at half the default amplitude.
       ...
       c = linkage(c,'average');
       c = cluster(c,'CUTOFF',.5,'Criterion','distance');
       plot(c,'event',.5,3);

 PLOT(C,'occurrence',SCALE,CLUSTERS) similar to EVENT plot above. Plots a time
 historgram for each event cluster together with a stack of all of the
 traces in that cluster. CLUSTERS specifies the number of each cluster to
 be included. Due to space constraints, no more than 10 clusters can be
 plotted on a single figure. Requires the CLUST property be filled. SCALE
 term is required for consistency but has little impact on the plots.</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function plot(c,varargin)</a>
0002 
0003 <span class="comment">% PLOT(C) plots waveforms stored in a correlation object. Traces are</span>
0004 <span class="comment">% aligned by their trigger times. For optimum correlation use ADJUSTTRIG</span>
0005 <span class="comment">% first. Trace amplitudes are normalized before plotting.</span>
0006 <span class="comment">%</span>
0007 <span class="comment">% PLOT(C,'wiggle') plots a wiggle trace (default for &lt; 100 traces)</span>
0008 <span class="comment">%</span>
0009 <span class="comment">% PLOT(C,'wiggle',SCALE) plots wiggle traces with relative amplitudes</span>
0010 <span class="comment">% of SCALE (default SCALE is 1.0 - no overlap for adjacent traces)</span>
0011 <span class="comment">%</span>
0012 <span class="comment">% PLOT(C,'wiggle',SCALE,PERM) plots the wiggle traces as specified and</span>
0013 <span class="comment">% ordered by the PERM vector. PERM may be a subset of the full list of</span>
0014 <span class="comment">% trace, a reordering of the traces, or both. The default behavior is to</span>
0015 <span class="comment">% plot traces as they appear in the TRIG field. One common use is to use</span>
0016 <span class="comment">% the PERM vector to plot traces in the same order they appear in a</span>
0017 <span class="comment">% dendrogram plot. For example:</span>
0018 <span class="comment">%       [H,tmp,perm] = dendrogram(c, ...);</span>
0019 <span class="comment">%       plot(c,'wig',1,perm);</span>
0020 <span class="comment">%</span>
0021 <span class="comment">% PLOT(C,'raw',...) same as 'wig' option except that traces are not</span>
0022 <span class="comment">% normalized to an equal amplitude before plotting. They are scaled to the</span>
0023 <span class="comment">% mean of the maximum trace amplitude. Scaling can be further refined</span>
0024 <span class="comment">% with the SCALE factor and/or by using the NORM function prior to plotting.</span>
0025 <span class="comment">%</span>
0026 <span class="comment">% PLOT(C,'shaded',...) plots shaded waveforms. (default for &gt;= 100 traces)</span>
0027 <span class="comment">% The 'wiggle' option is not conducive to displays of more than about 100</span>
0028 <span class="comment">% traces. The 'shaded' option is recommended for large datasets.  Plot</span>
0029 <span class="comment">% colors can be modified with the COLORMAP command. Same options are</span>
0030 <span class="comment">% available as for the wiggle plots.</span>
0031 <span class="comment">%</span>
0032 <span class="comment">% PLOT(C,'overlay',...) overlays the aligned traces on one another. The</span>
0033 <span class="comment">% stack of the traces is plotted in bold on top. If traces have not been</span>
0034 <span class="comment">% cropped prior to plotting, beware of odd effects toward the ends of the</span>
0035 <span class="comment">% stacked traces. Trace amplitudes are not normalized prior to plotting</span>
0036 <span class="comment">% (like 'raw'). Use NORM if normalization is necessary prior to plotting.</span>
0037 <span class="comment">%</span>
0038 <span class="comment">% PLOT(C,'interfer') plot shaded images of the correlation values and/or</span>
0039 <span class="comment">% lag times from behind the traces. See HELP INTERFEROGRAM for more</span>
0040 <span class="comment">% information on where this data comes from and how it is stored (a bit ad</span>
0041 <span class="comment">% hoc). Note that no trace normalization is applied to interferograms. In</span>
0042 <span class="comment">% many cases the user will choose to run the NORM command before plotting.</span>
0043 <span class="comment">% By default PLOT(C,'interfer') is the same as PLOT(C,'interfer',1,'LAG').</span>
0044 <span class="comment">%</span>
0045 <span class="comment">% PLOT(C,'interfer',SCALE,'CORR') plots a shaded image of the correlation</span>
0046 <span class="comment">% values from the interferogram routine behind the traces. Lag times are</span>
0047 <span class="comment">% ignored in this style of plot.</span>
0048 <span class="comment">%</span>
0049 <span class="comment">% PLOT(C,'interfer',SCALE,'LAG',RANGE) plots traces on a shaded image that</span>
0050 <span class="comment">% is a function of both the lag time and the correlation value. The color</span>
0051 <span class="comment">% scale ranges from -RANGE to +RANGE seconds. If RANGE is not included, then</span>
0052 <span class="comment">% it is set to 0.03 seconds. As the correlation value drops, the colors are</span>
0053 <span class="comment">% increasingly faded. Regions of the waveforms that correlate at less than</span>
0054 <span class="comment">% 0.6 are considered unreliable and are not colored at all. For example,</span>
0055 <span class="comment">% bright red indicates a waveform segment that correlates very well but is</span>
0056 <span class="comment">% delayed relative to the reference trace. Faded blue indicates moderate</span>
0057 <span class="comment">% correlation and advanced arrival. Yellow is no time shift. White</span>
0058 <span class="comment">% signifies poor correlation (in which case the lag time is meaningless).</span>
0059 <span class="comment">%</span>
0060 <span class="comment">% PLOT(C,'sample',...) same as wiggle plot except that individual sample</span>
0061 <span class="comment">% points are plotted. Really this is only useful for debugging.</span>
0062 <span class="comment">%</span>
0063 <span class="comment">% PLOT(C,'corr') plots an image of the correlation matrix. Requires</span>
0064 <span class="comment">% CORR field to be filed.</span>
0065 <span class="comment">%</span>
0066 <span class="comment">% PLOT(C,'lag') plots an image of the lag matrix. Requires LAG field to be</span>
0067 <span class="comment">% filled.</span>
0068 <span class="comment">%</span>
0069 <span class="comment">% PLOT(C,'stat') plots the delay time statistics for each trace. Requires STAT</span>
0070 <span class="comment">% field to be filled. If STAT field is not filled, PLOT(C,'STAT') will call</span>
0071 <span class="comment">% GETSTAT. The resulting values will be used for plotting but will *not* be</span>
0072 <span class="comment">% saved into C.</span>
0073 <span class="comment">%</span>
0074 <span class="comment">% PLOT(D,'den') plots a dendrogram image. Requires the LINK field to be</span>
0075 <span class="comment">% filled (see correlation/linkage).</span>
0076 <span class="comment">%</span>
0077 <span class="comment">% PLOT(C,'event') This routine has been deprecated and will be removed in a</span>
0078 <span class="comment">% future release. Use the occurence plot routine instead. The event routine</span>
0079 <span class="comment">% plots the time evolution of each event cluster together with a stack of</span>
0080 <span class="comment">% all of the traces in that cluster. No normalization is applied to the</span>
0081 <span class="comment">% traces before stacking. Requires the CLUST property be filled.</span>
0082 <span class="comment">%</span>
0083 <span class="comment">% PLOT(C,'event',SCALE)</span>
0084 <span class="comment">% PLOT(C,'event',SCALE,CLUSTERS)</span>
0085 <span class="comment">% Same as above except relative trace amplitudes are scaled by SCALE.</span>
0086 <span class="comment">% Default is 1. If specified, CLUSTERS states how many clusters to include</span>
0087 <span class="comment">% in the analysis. That is, if CLUSTERS is 5, then the 5 largest clusters</span>
0088 <span class="comment">% are included in the plots. The default value of CLUSTERS is 4.</span>
0089 <span class="comment">% Example - plot the 3 largest clusters at half the default amplitude.</span>
0090 <span class="comment">%       ...</span>
0091 <span class="comment">%       c = linkage(c,'average');</span>
0092 <span class="comment">%       c = cluster(c,'CUTOFF',.5,'Criterion','distance');</span>
0093 <span class="comment">%       plot(c,'event',.5,3);</span>
0094 <span class="comment">%</span>
0095 <span class="comment">% PLOT(C,'occurrence',SCALE,CLUSTERS) similar to EVENT plot above. Plots a time</span>
0096 <span class="comment">% historgram for each event cluster together with a stack of all of the</span>
0097 <span class="comment">% traces in that cluster. CLUSTERS specifies the number of each cluster to</span>
0098 <span class="comment">% be included. Due to space constraints, no more than 10 clusters can be</span>
0099 <span class="comment">% plotted on a single figure. Requires the CLUST property be filled. SCALE</span>
0100 <span class="comment">% term is required for consistency but has little impact on the plots.</span>
0101 
0102 <span class="comment">% Author: Michael West, Geophysical Institute, Univ. of Alaska Fairbanks</span>
0103 <span class="comment">% $Date$</span>
0104 <span class="comment">% $Revision$</span>
0105 
0106 
0107 
0108 <span class="comment">% SET VAR5 (USED ARBITRARILY BY SOME SUBFUNCTIONS)</span>
0109 <span class="keyword">if</span> length(varargin)&gt;=4
0110     var5 = varargin{4};
0111 <span class="keyword">else</span>
0112     var5 = [];
0113 <span class="keyword">end</span>;
0114 
0115 
0116 <span class="comment">% SET ORDER AND NUMBER OF TRACES</span>
0117 <span class="keyword">if</span> length(varargin)&gt;=3
0118     ord = reshape(varargin{3},1,length(varargin{3}));
0119 <span class="keyword">else</span>
0120     ord = 1:length(c.trig);
0121 <span class="keyword">end</span>;
0122 
0123 
0124 <span class="comment">% SET TRACE SCALE</span>
0125 <span class="keyword">if</span> length(varargin)&gt;=2
0126     scale = varargin{2};
0127 <span class="keyword">else</span>
0128     scale = 1;
0129 <span class="keyword">end</span>;
0130 
0131 <span class="comment">% PLOT SHADED TRACES, NOT WIGGLES</span>
0132 <span class="keyword">if</span> length(varargin)&gt;=1
0133     <span class="comment">%disp(varargin{1});</span>
0134     plottype = varargin{1};
0135 <span class="keyword">else</span>
0136     <span class="keyword">if</span> length(ord)&gt;=100
0137         plottype = <span class="string">'sha'</span>;
0138     <span class="keyword">else</span>
0139         plottype = <span class="string">'wig'</span>;
0140     <span class="keyword">end</span>
0141     
0142 <span class="keyword">end</span>;
0143 
0144 
0145 <span class="comment">% MAKE PLOT</span>
0146 <span class="keyword">if</span> strncmpi(plottype,<span class="string">'SHA'</span>,3)
0147     shadedplot(c,scale,ord);
0148 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'WIG'</span>,3)
0149     wiggleplot(c,scale,ord,1);
0150 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'RAW'</span>,3)
0151     wiggleplot(c,scale,ord,0);
0152 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'OVE'</span>,3)
0153     overlayplot(c,scale,ord);
0154 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'SAM'</span>,3)
0155     sampleplot(c,scale,ord);
0156 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'COR'</span>,3)
0157     corrplot(c);
0158 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'LAG'</span>,3)
0159     lagplot(c);
0160 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'STA'</span>,3)
0161     statplot(c);
0162 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'DEN'</span>,3)
0163     dendrogramplot(c);
0164 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'EVE'</span>,3)       <span class="comment">% ord field has been co-opted</span>
0165     admin.deprecated(<span class="string">'event plot'</span>,<span class="string">'occurence plot'</span>)
0166     <span class="keyword">if</span> length(ord) &gt; 1
0167         ord = 4;
0168     <span class="keyword">end</span>
0169     eventplot(c,scale,ord);
0170 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'OCC'</span>,3)       <span class="comment">% ord field has been co-opted</span>
0171     occurrenceplot(c,scale,ord);
0172 <span class="keyword">elseif</span> strncmpi(plottype,<span class="string">'INT'</span>,3)   <span class="comment">% ord is used as flag for &quot;corr&quot; vs. &quot;lag&quot;</span>
0173     ord = ord(1);
0174     <span class="keyword">if</span> isnumeric(ord)
0175        ord = <span class="string">'c'</span>; 
0176     <span class="keyword">end</span>
0177     <span class="keyword">if</span> isempty(var5)                <span class="comment">% var5 only used for lag plot</span>
0178         var5 = 0.03;
0179     <span class="keyword">end</span>
0180     wiggleinterferogram(c,scale,ord,0,var5);
0181 <span class="keyword">else</span>
0182     disp(<span class="string">'Plot type not recognized'</span>);
0183 <span class="keyword">end</span>;
0184 
0185 
0186 
0187 
0188</pre></div>
<hr><address>Generated on Sun 11-Oct-2015 14:40:09 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>